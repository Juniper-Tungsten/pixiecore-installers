###########################################################################
#
# the following MD5 encrypted passwords can be generated using
#
#    openssl passwd -1 redhat
#
#  see "man sslpasswd" for more information
#
###########################################################################
#rootpw --isencrypted $1$Su2Gv/$fZeEi7RtQq/RAZ1oEla5z0 # md5 encrypted "redhat"
#bootloader --location=mbr --md5pass=$1$x.3x1cDe$ucwc8hTScWzfb5DYW6r25/
install

###############################################################
# point to a local installation server, or use "cdrom"
###############################################################
text		# you're not going to be standing there watching it, are you?
auth --enableshadow --passalgo=sha512
url --url="ftp://192.168.3.10/centos7/repo"


###############################################################
# partitioning
###############################################################
zerombr 
bootloader --append=" crashkernel=auto" --location=mbr 
clearpart --all --initlabel --drives=sda,sdb
autopart 

# Run the Setup Agent on first boot
firstboot --enable


###############################################################
# network configuration
#   - the following is for the "recommended solution" outlined
#     in the Red Hat Academy Instructor's Guide
###############################################################
#network --bootproto=static --ip=192.168.0.254 --netmask=255.255.255.0 --device=eth0
network --bootproto=dhcp #--device=eth0
#firewall --enabled --http --ftp --port=https:tcp --port=ipp:tcp
firewall --disabled


###############################################################
# environment 
###############################################################
lang en_US
#timezone America/New_York
#timezone America/Chicago
#timezone America/Denver
timezone America/Los_Angeles

# Root password
rootpw Cisco1

# System timezone
user --groups=wheel --name=cisco --password=Cisco1 --gecos="Cisco"

###############################################################
# hardware 
###############################################################


###############################################################
# misc
###############################################################
auth  --useshadow  --enablemd5 
install				# instead of "upgrade"
reboot				# reboot automatically when done

###############################################################
#
# New in RHEL-4: SELinux
#
###############################################################
#selinux --enforcing
selinux --permissive
#selinux --disabled


###############################################################
#
# Software
#
###############################################################
%packages 


%end

%post
###############################################################
#
# Post Script - the following script runs on the newly
# installed machine, immediately after installation
#
###############################################################

cd /root
mkdir --mode=700 .ssh
cat >> .ssh/authorized_keys << "PUBLIC_KEY"
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCxcTpQf3FMTz1SvFNWHqWXzzUuw+fjQu6AFvJJZ0Y6yWgrJnoxhodmpLsJQrQon94jOpBWLWyzKNxyorSGa66TquKGMuUDmv2DLYk/mAsnkUYvEXAWD9RyJtx1i6YDA3aYoUwF6CyZYDbMaR/hYmdRXVsOELNtRyJsRaUtpKJkouW7ifGyOoEySGBnvpa3JKZ7Ic0UBmSs4Vsk5TCuBLoyoKZ+8H1+VSPZDLbbMXBxVa4aHLHAj6832QopZtuB9zweQw5HlehowzFl1zgTRDdedRqns66asbJEJuANP+0kButf7VALYE5Ps+iEVdBOWXRyv1H3b0XoXOEcsWUm9vSd /home/cisco/.ssh/id_rsa
PUBLIC_KEY
chmod 600 .ssh/authorized_keys
yum install -y epel-release ansible emacs-nox net-tools git
cd /home/cisco
mkdir --mode=700 .ssh
cat >> .ssh/authorized_keys << "PUBLIC_KEY"
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCxcTpQf3FMTz1SvFNWHqWXzzUuw+fjQu6AFvJJZ0Y6yWgrJnoxhodmpLsJQrQon94jOpBWLWyzKNxyorSGa66TquKGMuUDmv2DLYk/mAsnkUYvEXAWD9RyJtx1i6YDA3aYoUwF6CyZYDbMaR/hYmdRXVsOELNtRyJsRaUtpKJkouW7ifGyOoEySGBnvpa3JKZ7Ic0UBmSs4Vsk5TCuBLoyoKZ+8H1+VSPZDLbbMXBxVa4aHLHAj6832QopZtuB9zweQw5HlehowzFl1zgTRDdedRqns66asbJEJuANP+0kButf7VALYE5Ps+iEVdBOWXRyv1H3b0XoXOEcsWUm9vSd /home/cisco/.ssh/id_rsa
PUBLIC_KEY
chmod 600 .ssh/authorized_keys
chown -R cisco.cisco /home/cisco

########################################################
# turn on required services
########################################################

#chkconfig httpd on
#chkconfig vsftpd on


########################################################
# add proxy server to /etc/rha_server.conf, if necessary
########################################################

#echo "ExerciseReporterProxy  http://10.1.1.1:8080" >> /etc/rha_server.conf

%end

